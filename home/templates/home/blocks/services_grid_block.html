{% load wagtailimages_tags wagtailcore_tags services_tags %}

{# --- Services Grid: auto-pulls ServicePage entries into cards --- #}

<section class="bg-gray-50 py-16">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">

        <div class="text-center mb-12" data-aos="fade-up">
            <h2 class="text-3xl md:text-4xl font-bold text-gray-900 mb-4">
                {{ value.heading }}
            </h2>
            {% if value.subheading %}
            <p class="text-lg text-gray-600 max-w-2xl mx-auto">
                {{ value.subheading }}
            </p>
            {% endif %}
        </div>

        {% get_services featured_only=value.featured_only as services %}

        {% if services %}
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
            {% for service in services %}
            <div class="bg-white rounded-xl shadow-sm border border-gray-100 overflow-hidden hover:shadow-md transition"
                 data-aos="fade-up" data-aos-delay="{% cycle '0' '100' '200' %}">

                {% if service.service_image %}
                    {% image service.service_image fill-400x250 class="w-full h-48 object-cover" %}
                {% else %}
                    <div class="w-full h-48 bg-brand-100 flex items-center justify-center">
                        <svg class="w-12 h-12 text-brand-300" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5"
                                  d="m2.25 15.75 5.159-5.159a2.25 2.25 0 0 1 3.182 0l5.159 5.159m-1.5-1.5 1.409-1.409a2.25 2.25 0 0 1 3.182 0l2.909 2.909M3.75 21h16.5A2.25 2.25 0 0 0 22.5 18.75V5.25A2.25 2.25 0 0 0 20.25 3H3.75A2.25 2.25 0 0 0 1.5 5.25v13.5A2.25 2.25 0 0 0 3.75 21Z" />
                        </svg>
                    </div>
                {% endif %}

                <div class="p-6">
                    <h3 class="text-lg font-bold text-gray-900 mb-2">{{ service.title }}</h3>
                    <p class="text-gray-600 text-sm mb-4 line-clamp-2">{{ service.short_summary }}</p>

                    <div class="flex items-center justify-between">
                        <span class="text-brand-600 font-bold text-lg">{{ service.price_label }}</span>
                        {% if service.duration_label %}
                        <span class="text-gray-400 text-sm">{{ service.duration_label }}</span>
                        {% endif %}
                    </div>

                    <div class="mt-4 flex gap-3">
                        <a href="{% pageurl service %}"
                           class="flex-1 text-center text-brand-600 border border-brand-600 rounded-lg py-2 text-sm font-medium hover:bg-brand-50 transition">
                            Learn More
                        </a>
                        <a href="/booking/?service={{ service.slug }}"
                           class="flex-1 text-center bg-brand-600 text-white rounded-lg py-2 text-sm font-medium hover:bg-brand-700 transition">
                            Book Now
                        </a>
                    </div>
                </div>
            </div>
            {% endfor %}
        </div>
        {% else %}
        <p class="text-gray-500 text-center">Services coming soon.</p>
        {% endif %}

        <div class="text-center mt-10" data-aos="fade-up">
            <a href="/services/" class="text-brand-600 hover:text-brand-700 font-medium transition">
                View all services â†’
            </a>
        </div>

    </div>
</section>
