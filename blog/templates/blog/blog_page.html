{% extends "base.html" %}
{% load wagtailcore_tags wagtailimages_tags %}

{% block content %}
<article class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-16">

    {# --- Back link --- #}
    <div class="mb-8" data-aos="fade-up">
        <a href="{% pageurl page.get_parent %}"
           class="text-brand-600 hover:text-brand-700 font-medium transition">
            ← Back to Resources
        </a>
    </div>

    {# --- Article Header --- #}
    <header class="mb-8" data-aos="fade-up">
        <h1 class="text-4xl md:text-5xl font-bold text-gray-900 mb-4">
            {{ page.title }}
        </h1>

        <div class="flex items-center gap-3 text-gray-500">
            <time datetime="{{ page.publish_date|date:'Y-m-d' }}" class="text-sm">
                {{ page.publish_date|date:"F d, Y" }}
            </time>
            <span>·</span>
            <span class="text-sm">{{ page.author_name }}</span>
        </div>
    </header>

    {# --- Cover Image --- #}
    {% if page.cover_image %}
    <div class="mb-8 rounded-xl overflow-hidden shadow-lg" data-aos="fade-up">
        {% image page.cover_image width-800 class="w-full h-auto" %}
    </div>
    {% endif %}

    {# --- Excerpt / Summary --- #}
    <div class="bg-brand-50 border-l-4 border-brand-500 p-6 rounded-r-xl mb-8" data-aos="fade-up">
        <p class="text-gray-700 text-lg italic">
            {{ page.excerpt }}
        </p>
    </div>

    {# --- Article Body --- #}
    <div class="prose prose-lg prose-teal max-w-none mb-12" data-aos="fade-up">
        {{ page.body|richtext }}
    </div>

    {# --- Citation / Source Credit --- #}
    {% if page.citation %}
    <div class="bg-gray-50 border border-gray-200 rounded-xl p-6 mb-12" data-aos="fade-up">
        <h3 class="text-sm font-bold text-gray-900 uppercase tracking-wide mb-2 flex items-center gap-2">
            <svg class="w-4 h-4 text-brand-600" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                      d="M19.5 14.25v-2.625a3.375 3.375 0 0 0-3.375-3.375h-1.5A1.125 1.125 0 0 1 13.5 7.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H8.25m0 12.75h7.5m-7.5 3H12M10.5 2.25H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 0 0-9-9Z" />
            </svg>
            Source
        </h3>
        <p class="text-gray-600 text-sm leading-relaxed">
            {{ page.citation }}
        </p>
        {% if page.source_url %}
        <a href="{{ page.source_url }}"
           target="_blank"
           rel="noopener noreferrer"
           class="inline-flex items-center gap-1 text-brand-600 hover:text-brand-700 text-sm font-medium mt-2 transition">
            View original article
            <svg class="w-3.5 h-3.5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                      d="M13.5 6H5.25A2.25 2.25 0 0 0 3 8.25v10.5A2.25 2.25 0 0 0 5.25 21h10.5A2.25 2.25 0 0 0 18 18.75V10.5m-10.5 6L21 3m0 0h-5.25M21 3v5.25" />
            </svg>
        </a>
        {% endif %}
    </div>
    {% endif %}

    {# --- CTA --- #}
    <div class="border-t border-gray-200 pt-8 text-center" data-aos="fade-up">
        {% if page.related_service %}
        <p class="text-gray-600 mb-2">Interested in this service?</p>
        <p class="text-lg font-semibold text-gray-900 mb-1">{{ page.related_service.title }}</p>
        <p class="text-gray-500 text-sm mb-4">{{ page.related_service.price_label }}{% if page.related_service.duration_label %} · {{ page.related_service.duration_label }}{% endif %}</p>
        <div class="flex flex-col sm:flex-row items-center justify-center gap-3">
            {% if page.related_service.cal_booking_url %}
            <a href="/booking/?service={{ page.related_service.slug }}"
               class="inline-block bg-brand-600 text-white font-semibold px-8 py-4 rounded-lg text-lg hover:bg-brand-700 transition shadow-lg hover:shadow-xl">
                Book This Service
            </a>
            {% endif %}
            <a href="{% pageurl page.related_service %}"
               class="inline-block border-2 border-brand-600 text-brand-600 font-semibold px-8 py-4 rounded-lg text-lg hover:bg-brand-50 transition">
                View Service Details
            </a>
        </div>
        {% else %}
        <p class="text-gray-600 mb-4">Interested in learning more?</p>
        <a href="/booking/"
           class="inline-block bg-brand-600 text-white font-semibold px-8 py-4 rounded-lg text-lg hover:bg-brand-700 transition shadow-lg hover:shadow-xl">
            Book an Appointment
        </a>
        {% endif %}
    </div>

</article>
{% endblock %}
